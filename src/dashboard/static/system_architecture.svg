<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 18px; font-weight: bold; fill: #333; }
      .component { font-family: Arial, sans-serif; font-size: 12px; fill: #333; }
      .label { font-family: Arial, sans-serif; font-size: 10px; fill: #666; }
      .flow-text { font-family: Arial, sans-serif; font-size: 9px; fill: #444; }
      .honeypot { fill: #ffeb3b; stroke: #f57f17; stroke-width: 2; }
      .ids { fill: #f44336; stroke: #c62828; stroke-width: 2; }
      .database { fill: #4caf50; stroke: #2e7d32; stroke-width: 2; }
      .dashboard { fill: #2196f3; stroke: #1565c0; stroke-width: 2; }
      .attacker { fill: #ff9800; stroke: #e65100; stroke-width: 2; }
      .flow-arrow { stroke: #666; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .data-flow { stroke: #9c27b0; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="400" y="25" text-anchor="middle" class="title">PHIDS System Architecture &amp; Data Flow</text>
  
  <!-- Attacker -->
  <rect x="50" y="80" width="100" height="60" class="attacker" rx="5"/>
  <text x="100" y="105" text-anchor="middle" class="component">Attacker</text>
  <text x="100" y="120" text-anchor="middle" class="label">External Threat</text>
  
  <!-- SSH Honeypot -->
  <rect x="200" y="50" width="120" height="60" class="honeypot" rx="5"/>
  <text x="260" y="75" text-anchor="middle" class="component">SSH Honeypot</text>
  <text x="260" y="90" text-anchor="middle" class="label">Port 2222</text>
  <text x="260" y="105" text-anchor="middle" class="label">Paramiko Server</text>
  
  <!-- HTTP Honeypot -->
  <rect x="200" y="130" width="120" height="60" class="honeypot" rx="5"/>
  <text x="260" y="155" text-anchor="middle" class="component">HTTP Honeypot</text>
  <text x="260" y="170" text-anchor="middle" class="label">Port 8081</text>
  <text x="260" y="185" text-anchor="middle" class="label">Fake Web Apps</text>
  
  <!-- IDS Engine -->
  <rect x="380" y="90" width="120" height="80" class="ids" rx="5"/>
  <text x="440" y="115" text-anchor="middle" class="component">IDS Engine</text>
  <text x="440" y="130" text-anchor="middle" class="label">Signature Detection</text>
  <text x="440" y="145" text-anchor="middle" class="label">Pattern Analysis</text>
  <text x="440" y="160" text-anchor="middle" class="label">Alert Generation</text>
  
  <!-- Database -->
  <rect x="380" y="220" width="120" height="80" class="database" rx="5"/>
  <text x="440" y="245" text-anchor="middle" class="component">SQLite Database</text>
  <text x="440" y="260" text-anchor="middle" class="label">Connections</text>
  <text x="440" y="275" text-anchor="middle" class="label">Alerts</text>
  <text x="440" y="290" text-anchor="middle" class="label">Auth Events</text>
  
  <!-- Dashboard -->
  <rect x="560" y="90" width="120" height="80" class="dashboard" rx="5"/>
  <text x="620" y="115" text-anchor="middle" class="component">Web Dashboard</text>
  <text x="620" y="130" text-anchor="middle" class="label">Port 5001</text>
  <text x="620" y="145" text-anchor="middle" class="label">FastAPI + WebSocket</text>
  <text x="620" y="160" text-anchor="middle" class="label">Real-time Updates</text>
  
  <!-- SOC Analyst -->
  <rect x="560" y="220" width="120" height="60" class="attacker" rx="5"/>
  <text x="620" y="245" text-anchor="middle" class="component">SOC Analyst</text>
  <text x="620" y="260" text-anchor="middle" class="label">Security Monitoring</text>
  
  <!-- Attack Flow Arrows -->
  <line x1="150" y1="110" x2="195" y2="80" class="flow-arrow"/>
  <text x="170" y="90" class="flow-text">SSH Attack</text>
  
  <line x1="150" y1="110" x2="195" y2="160" class="flow-arrow"/>
  <text x="170" y="140" class="flow-text">HTTP Attack</text>
  
  <!-- Data Flow Arrows -->
  <line x1="320" y1="80" x2="375" y2="110" class="data-flow"/>
  <text x="340" y="90" class="flow-text">SSH Data</text>
  
  <line x1="320" y1="160" x2="375" y2="140" class="data-flow"/>
  <text x="340" y="155" class="flow-text">HTTP Data</text>
  
  <line x1="440" y1="170" x2="440" y2="215" class="data-flow"/>
  <text x="450" y="195" class="flow-text">Store Events</text>
  
  <line x1="500" y1="260" x2="555" y2="130" class="data-flow"/>
  <text x="520" y="190" class="flow-text">Query Data</text>
  
  <line x1="620" y1="170" x2="620" y2="215" class="data-flow"/>
  <text x="630" y="195" class="flow-text">Monitor</text>
  
  <!-- Data Flow Legend -->
  <rect x="50" y="350" width="700" height="200" fill="#f5f5f5" stroke="#ccc" stroke-width="1" rx="5"/>
  <text x="400" y="375" text-anchor="middle" class="title">Data Flow Process</text>
  
  <!-- Step 1 -->
  <circle cx="80" cy="400" r="15" fill="#ff9800" stroke="#e65100" stroke-width="2"/>
  <text x="80" y="405" text-anchor="middle" class="component">1</text>
  <text x="110" y="405" class="component">Attacker sends malicious requests to honeypots</text>
  
  <!-- Step 2 -->
  <circle cx="80" cy="430" r="15" fill="#ffeb3b" stroke="#f57f17" stroke-width="2"/>
  <text x="80" y="435" text-anchor="middle" class="component">2</text>
  <text x="110" y="435" class="component">Honeypots capture and log all interaction data</text>
  
  <!-- Step 3 -->
  <circle cx="80" cy="460" r="15" fill="#f44336" stroke="#c62828" stroke-width="2"/>
  <text x="80" y="465" text-anchor="middle" class="component">3</text>
  <text x="110" y="465" class="component">IDS Engine analyzes patterns and generates alerts</text>
  
  <!-- Step 4 -->
  <circle cx="80" cy="490" r="15" fill="#4caf50" stroke="#2e7d32" stroke-width="2"/>
  <text x="80" y="495" text-anchor="middle" class="component">4</text>
  <text x="110" y="495" class="component">All data stored in SQLite database with timestamps</text>
  
  <!-- Step 5 -->
  <circle cx="80" cy="520" r="15" fill="#2196f3" stroke="#1565c0" stroke-width="2"/>
  <text x="80" y="525" text-anchor="middle" class="component">5</text>
  <text x="110" y="525" class="component">Dashboard provides real-time monitoring and analysis</text>
  
  <!-- Key Features -->
  <text x="450" y="405" class="component">Key Features:</text>
  <text x="450" y="425" class="label">• Sub-second attack detection</text>
  <text x="450" y="440" class="label">• Real-time WebSocket updates</text>
  <text x="450" y="455" class="label">• Attack success simulation</text>
  <text x="450" y="470" class="label">• Geolocation analysis</text>
  <text x="450" y="485" class="label">• CSV export for SIEM</text>
  <text x="450" y="500" class="label">• Educational attack patterns</text>
  <text x="450" y="515" class="label">• Professional SOC interface</text>
  <text x="450" y="530" class="label">• Comprehensive logging</text>
</svg>
